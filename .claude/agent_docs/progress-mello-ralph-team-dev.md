**Project:** ComfyuME Multi-User ComfyUI Workshop Platform
**Project Started:** 2026-01-02
**Repository:** github.com/ahelme/comfyume-v1
**Domain:** aiworkshop.art (production) Â· anegg.app (testing)
**Doc Created:** 2026-02-11
**Doc Updated:** 2026-02-22

| Environment | URL | Instance | SSH |
|---|---|---|---|
| **Production** | https://aiworkshop.art | quiet-city (65.108.33.101) | `ssh dev@100.89.38.43` |
| **Testing (active)** | https://anegg.app | intelligent-rain-shrinks (65.108.33.80) | `ssh root@65.108.33.80` |

**All teams are currently working on the testing instance (anegg.app). Do NOT deploy to production without explicit approval.**

---
# Project Progress Tracker â€” MELLO RALPH TEAM (Autonomous QA)
**Target:** Workshop Feb 25 2026
**MAIN Repo:** comfyume-v1 (https://github.com/ahelme/comfyume-v1)
**Branch:** mello-ralph-team
**Deploy branch:** testing-009 (shared â€” merge here before deploying to anegg.app)
**Phase:** FIX LOOP â€” autonomous workflow testing via Ralph Loop
---
## 0. Update Instructions

   RE: PRIORITY TASKS
   **UPDATE:**
     - WHEN NEW TASKS EMERGE
     - AT END OF SESSION - YOU MUST UPDATE/CULL TASKS

   **ALWAYS reference issues in our TWO Github Issue Trackers**
      - comfyume-v1: github.com/ahelme/comfyume-v1/issues/
      - private scripts: github.com/ahelme/comfymulti-scripts/issues/

   **FORMAT:**
          [status] [PRIORITY] [GH#s] [SHORT DESC.]
             - [DATE-CREATED] [DATE-UPDATED]
               - CONCISE NOTES
   **BE CONCISE**

   RE: Progress Reports (NEWEST AT TOP!)
     **CRITICAL DETAIL - NO FLUFF**
     **UPDATE OFTEN**
---
## 1. PRIORITY TASKS

ðŸŸ¢ **RESOLVED - QA Loop: Workflow 1 (Flux2 Klein 9B) passing all criteria**
    - Created: 2026-02-11, Resolved: 2026-02-12
    - Ralph Loop ran 4 iterations overnight, found and fixed 3 bugs
    - BUG-001: Image delivery gap â€” PRs #23, #24, #25, #26, #27, #28
    - BUG-002: SFS permissions â€” server-side chmod 1777
    - BUG-003: Missing --output-directory â€” Verda SDK update_deployment()
    - All 8 criteria passing: load, queue_response, status_banner, qm_serverless, no_js_errors, output_display, queue_history, sidebar_assets
    - Changes committed by Mello Team One on `ralph-changes-unlogged` branch (PR #32)

ðŸ”´ **(NEXT) - QA Loop: Test remaining 4 workflows**
    - Created: 2026-02-12
    - Workflows remaining:
      2. Flux2 Klein 4B (text â†’ image)
      3. LTX-2 (text â†’ video)
      4. LTX-2 Distilled (text â†’ video)
      5. Example Workflow (basic)
    - Depends on: testing instance setup (Phase 2)

---

# Progress Reports

---

## Progress Report 1 - 2026-02-11 - Team created, fix loop ready

**Date:** 2026-02-11

### Team setup:
- Mello Ralph Team created with full skill structure (resume, handover, progress)
- fix loop skill created with 6-phase protocol (PR #17, #18)
- qa-state.json initialized with all 5 workflows as "untested"
- Ralph Loop recommended: `--max-iterations 50 --completion-promise "ALL_WORKFLOWS_PASSING"`

### Known state:
- 24 containers healthy on quiet-city (65.108.33.101)
- Serverless inference confirmed working (DataCrunch H200, HTTP 200 OK)
- Status banner deployed (redirect.js floating overlay)
- default_workflow_loader DISABLED (canvas null errors)
- Image delivery gap is the main unsolved problem

### Ready to start testing!

---

## Progress Report 3 - 2026-02-12 - Ralph Loop SUCCESS â€” Workflow 1 passing all 8 criteria

**Date:** 2026-02-12 | **Issues:** #22 | **PRs:** #23-#28, #32

### Overnight run (4 iterations):

**Iteration 1:** Diagnosed image delivery gap. 5/7 criteria pass, GPU works, images stranded on serverless container.
**Iteration 2:** Implemented 3-part fix: serverless_proxy extension, QM image fetching, redirect.js defer. But timeouts during cold start.
**Iteration 3:** Tuned timeouts (600s max, 10s per-poll). Pivoted from HTTP image download to SFS-based delivery (DataCrunch routes requests to different instances, breaking /view).
**Iteration 4:** PASS. Fixed SFS permissions (1777) and DataCrunch --output-directory flag. All 8 criteria green.

### Bugs found and fixed:
1. **BUG-001** (code): QM `submit_to_serverless()` never fetched images â†’ added history polling + SFS copy
2. **BUG-002** (server-side): SFS `/mnt/sfs/outputs/` permissions 755â†’1777
3. **BUG-003** (server-side): DataCrunch start command missing `--output-directory /mnt/sfs/outputs`

### PRs merged (all to main):
- PR #23: Core image delivery fix (serverless_proxy + QM fetching)
- PR #24: /api/health route alias
- PR #25: history_result attribute fix
- PR #26: Polling diagnostics + timeout increase
- PR #27: 600s max_wait, 10s per-poll
- PR #28: SFS-based image delivery

### Key architecture decision:
Abandoned HTTP image download in favor of SFS file-based delivery. DataCrunch routes HTTP requests to different container instances (load balancer), so `/view` returns 404 for images generated by a different instance. SFS is shared NFS â€” same file visible to all containers and the app server.

---

## Progress Report 2 - 2026-02-11 - Ralph Loop first run, credential fix

**Date:** 2026-02-11

### Changes:
- Ralph Loop plugin activated and tested â€” `/ralph-loop:ralph-loop` invocation confirmed working (PR #21)
- Switched QA test user from user011 â†’ user001
- Removed hardcoded credentials from tracked skill files â€” now references `.env` line 367 at runtime
- qa-state.json updated: iteration 1, workflow 1 set to "testing"

### Observations:
- All 24 containers healthy on quiet-city
- QM running: serverless mode, H200-141GB-SPOT, Redis connected
- HTTP Basic Auth requires URL-encoded credentials for Chrome DevTools automation
- Ralph Loop `/help` confirms: stop hook intercepts exit, feeds same prompt back

### Next:
- Continue Ralph Loop iteration 1: test Flux2 Klein 9B workflow via Chrome DevTools
- Navigate to user001 with auth, load workflow, queue prompt, observe results

---
